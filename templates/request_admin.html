<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
        <title>Request to Join Admin</title>
    </head>

    <body class="admin register-page">

        <!-- Navigation Bar -->
        <div class="page-container">
        <header>
            <a class="header-logo"><span>ebFit</span></a>
            <a href="{{ url_for('home') }}" class="nav-items">
                    <i class="fa-solid fa-house"></i>
                </a>
        </header>
        </div>

        <div id="page" class="site">
            <div class="container2">
                <div class="login">

                    <!-- Left Hero -->
                    <div class="hero">
                        <h1>Welcome <br>Admin.</h1>
                        <p>
                            If you already have an admin account,<br>
                            <a href="{{ url_for('login_admin') }}">Login here</a>.
                        </p>
                            
                        <p> Check approval status,<a href="#" onclick="document.getElementById('approvalModal').style.display='block'">Click Here.</a>
                        </p>
                    </div>

                    <!-- Right Form -->
                    <div class="main">
                        <div class="login-box">

                            {% with messages = get_flashed_messages() %}
                            {% if messages %}
                            {% for message in messages %}
                            <div class="popup">
                                <div class="popup-content">
                                    <p>{{ message }}</p>
                                    <a href="{{ request.path }}"><button class="submit">OK</button></a>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}
                            {% endwith %}

                            <form action="{{ url_for('request_admin') }}" method="POST">
                                <h2 class="form-title">Request Admin</h2>

                                <p class="colortext">
                                    <span><strong>Email address</strong></span>
                                    <input type="email" name="admin_email" required>
                                </p>

                                <p class="colortext">
                                    <span><strong>Full name</strong></span>
                                    <input type="text" name="admin_name" required>
                                </p>

                                <p class="colortext">
                                    <span><strong>Password</strong></span>
                                    <input type="password" name="password" required>
                                </p>

                                <p class="colortext">
                                    <span><strong>Join reason</strong></span>
                                    <input type="text" name="join_reason" required>
                                </p>

                                <div class="btn-group">
                                    <input type="submit" class="big-cta-btn" value="Request">
                                </div>
                            </form>

                        </div>
                    </div>

                </div>
            </div>
        </div>
        
        
       <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Check Approval</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<div id="approvalModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="document.getElementById('approvalModal').style.display='none'">&times;</span>
        <h2>Check Approval Status</h2>

        {% if approval_status is not defined %}
        <!-- Step 1: ask for email -->
        <form method="POST" action="{{ url_for('check_approval') }}">
            <label>Email address</label>
            <input type="email" name="admin_email" required>
            <div class="btn-group">
                <input type="submit" class="big-cta-btn" value="Check Status">
            </div>
        </form>

        {% else %}
        <!-- Step 2: show status -->
        {% if approval_status == "pending" %}
            <p>Status: <strong>Pending</strong></p>
        {% elif approval_status == "approved" %}
            <p>Status: <strong>Approved</strong></p>
        {% elif approval_status == "rejected" %}
            <p>Status: <strong>Rejected</strong></p>
        {% else %}
            <p>Status: <strong>Not Found</strong></p>
        {% endif %}

        <div class="btn-group">
            <!-- Done button resets modal -->
            <a href="{{ url_for('request_admin') }}" class="big-cta-btn">Done</a>
        </div>
        {% endif %}

    </div>
</div>

<!-- Auto-open modal if Flask sets flag -->
{% if open_approval_modal %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("approvalModal").style.display = "block";
    });
</script>
{% endif %}

</body>
</html>