{% extends "base.html" %}
{% block content %}
<div class="container">

    <h1>Sports Activity Posts</h1>

    <form class="searchingbar" method ="GET" action="{{ url_for('search') }}">
        <input type="text" name="sport" placeholder="Search by Category..." value="{{sport or '' }}">
        <button type="submit">Search</button>
    </form>

    <form class="searchingdate" method ="GET" action="{{ url_for('search') }}">
    <label><b>Choose Date: </b></label>
        <input type="date" name="date" value="{{ date or '' }}">
        <input type="hidden" name="sport" value="{{ sport or '' }}">
        <button type="submit">Apply</button>
    </form>

{% if searched %}
    {% if results %} 
        {% for post in results %}
        <div class="post">

            <div class="post-header">
            <h2>{{ post.title }}</h2>
            <div class="post-menu">
                <button class="menu-btn">â‹®</button>
                <div class="menu-dropdown">
                    <a href="#">Report</a>
                </div>
            </div>
        </div>

            <p class="meta">
                Event: {{ post.event_datetime }} | {{ post.location }}
            </p>
            <p class="meta">
                Posted on {{ post.local_date_posted_value.strftime('%Y-%m-%d %H:%M') if post.local_date_posted_value else '' }}
            </p>
            
            <a href="{{ url_for('post_detail', post_id=post.id) }}" class="btn">Find Out More</a>
            <button class="btn join-btn">Request to Join</button>
            <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn">Edit</a>

            <div>
                <form method="POST" action="{{ url_for('delete', post_id=post.id) }}" onsubmit="return confirm('Are you sure you want to delete this post?');">
                    <button type="submit" class="btn delete-btn">Delete</button>
                </form>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p>No posts related to {{ sport }}</p>
    {% endif %}
{% else %}
<p>Please enter a sport category</p>
{% endif %}
</div>
{% endblock %}
